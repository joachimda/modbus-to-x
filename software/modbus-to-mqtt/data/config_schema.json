{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "ModbusToXConfig",
  "type": "object",
  "required": [
    "version",
    "bus1",
    "bus2",
    "devices"
  ],
  "properties": {
    "version": {
      "type": "integer",
      "minimum": 1
    },
    "bus1": {
      "type": "object",
      "required": [
        "baud",
        "serialFormat",
        "termination",
        "enableBias"
      ],
      "properties": {
        "baud": {
          "type": "integer",
          "enum": [
            1200,
            2400,
            4800,
            9600,
            19200,
            38400,
            57600,
            115200,
            230400,
            460800,
            921600
          ]
        },
        "serialFormat": {
          "type": "string",
          "enum": [
            "5N1",
            "6N1",
            "7N1",
            "8N1",
            "5N2",
            "6N2",
            "7N2",
            "8N2",
            "5E1",
            "6E1",
            "7E1",
            "8E1",
            "5E2",
            "6E2",
            "7E2",
            "8E2",
            "5O1",
            "6O1",
            "7O1",
            "8O1",
            "5O2",
            "6O2",
            "7O2",
            "8O2"
          ]
        },
        "termination": {
          "type": "string",
          "enum": [
            "120R"
          ]
        },
        "enableBias": {
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "bus2": {
      "type": "object",
      "required": [
        "baud",
        "serialFormat",
        "termination",
        "enableBias"
      ],
      "properties": {
        "baud": {
          "type": "integer",
          "enum": [
            1200,
            2400,
            4800,
            9600,
            19200,
            38400,
            57600,
            115200,
            230400,
            460800,
            921600
          ]
        },
        "serialFormat": {
          "type": "string",
          "enum": [
            "5N1",
            "6N1",
            "7N1",
            "8N1",
            "5N2",
            "6N2",
            "7N2",
            "8N2",
            "5E1",
            "6E1",
            "7E1",
            "8E1",
            "5E2",
            "6E2",
            "7E2",
            "8E2",
            "5O1",
            "6O1",
            "7O1",
            "8O1",
            "5O2",
            "6O2",
            "7O2",
            "8O2"
          ]
        },
        "termination": {
          "type": "string",
          "enum": [
            "120R"
          ]
        },
        "enableBias": {
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "devices": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": [
          "name",
          "busId",
          "slaveId",
          "defaultByteOrder",
          "dataPoints"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "busId": {
            "type": "integer",
            "enum": [1,2]
          },
          "slaveId": {
            "type": "integer",
            "minimum": 1,
            "maximum": 247
          },
          "defaultByteOrder": {
            "type": "string",
            "enum": [
              "ABCD",
              "DCBA"
            ]
          },
          "dataPoints": {
            "type": "array",
            "minimum": 0,
            "maximum": 200,
            "items": {
              "type": "object",
              "required": [
                "id",
                "name",
                "address",
                "registerType",
                "dataType",
                "access"
              ],
              "properties": {
                "id":{
                  "type": "string"
                },
                 "name": {
                  "type": "string",
                  "minLength": 1,
                  "maxLength": 16
                },
                "address": {
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 65535
                },
                "numOfRegisters": {
                  "type": "integer",
                  "minimum": 1,
                  "maximum": 125,
                  "default": 1
                },
                "scale": {
                  "type": "number",
                  "default": 1.0
                },
                "registerType": {
                  "type": "string",
                  "enum": [
                    "H",
                    "I"
                  ]
                },
                "dataType": {
                  "type": "string",
                  "enum": [
                    "TEXT",
                    "F32",
                    "S16",
                    "DATE"
                  ]
                },
                "unit": {
                  "type":"string",
                  "minLength": 0,
                  "maxLength": 5,
                  "default": ""
                },
                "access":{
                  "type": "string",
                  "enum": ["r", "rw"]
                },
                "pollMs":{
                  "type": "integer",
                  "minimum": 100,
                  "default": 10000
                },
                "deadBand":{
                  "type": "number",
                  "default": 0.0
                },
                "precision":{
                  "type":"integer",
                  "default": 1,
                  "minimum": 0,
                  "maximum": 10
                }
              },
              "additionalProperties": false
            }
          }
        },
        "additionalProperties": false
      },
      "modbus": {
        "type": "object",
        "properties": {
          "timeoutMs": {
            "type": "integer",
            "minimum": 1,
            "maximum": 10000
          },
          "retries": {
            "type": "integer",
            "minimum": 0,
            "maximum": 10
          }
        },
        "additionalProperties": false
      }
    }
  }
}